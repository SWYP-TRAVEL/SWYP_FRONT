"use strict";(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[957],{"./src/components/Card.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Card});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_Text__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/components/Text.tsx");const CARD_STYLES={large:"h-[460px] p-6 rounded-[20px] border-4 border-transparent hover:border-[#9A77FF] text-white bg-cover bg-center transition-all",medium:"h-[360px] p-6 rounded-xl border-4 border-transparent hover:border-[#9A77FF] text-white bg-cover bg-center transition-all",small:"h-[120px] p-5 rounded-[12px] border-4 border-transparent text-white bg-cover bg-center transition-all"},CARD_WIDTHS={large:"340px",medium:"280px",small:"300px"},CARD_TEXT_STYLES={large:{region:"title2",info:"label2"},medium:{region:"title2",info:"label2"},small:{region:"heading2",info:"label2"}};function Card({imageUrl="https://cdn.visitkorea.or.kr/img/call?cmd=VIEW&id=5dc87836-b647-45ef-ae17-e3247f91b8b4",region,distanceInfo,regionTextStyle,infoTextStyle,size="large",width,onClick,as:Component="div"}){const resolvedRegionTextStyle=null!=regionTextStyle?regionTextStyle:CARD_TEXT_STYLES[size].region,resolvedInfoTextStyle=null!=infoTextStyle?infoTextStyle:CARD_TEXT_STYLES[size].info,textAlignClass="small"===size?"justify-start":"justify-end",endAlignClass="small"===size?"items-start":"items-end",customStyles={width:null!=width?width:CARD_WIDTHS[size]};return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(Component,{className:`${CARD_STYLES[size]} relative overflow-hidden cursor-pointer`,style:customStyles,onClick,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:`url(${imageUrl})`}}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"absolute inset-0 bg-black/30"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:`relative z-10 flex flex-col ${textAlignClass} h-full gap-2`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:`flex ${endAlignClass} gap-2 min-h-[76px]`,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_Text__WEBPACK_IMPORTED_MODULE_1__.A,{textStyle:resolvedRegionTextStyle,className:"font-bold overflow-hidden text-ellipsis line-clamp-2",children:region}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("img",{src:"/icons/link.svg",alt:"icon",className:"w-6 h-6 mt-[2px]"})]}),"small"!==size&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_Text__WEBPACK_IMPORTED_MODULE_1__.A,{textStyle:resolvedInfoTextStyle,className:"font-bold text-white font-pretendard text-[20px] font-semibold leading-[140%] tracking-[-0.24px] overflow-hidden text-ellipsis line-clamp-2 min-h-[48px]",children:distanceInfo})]})]})}Card.__docgenInfo={description:"",methods:[],displayName:"Card",props:{imageUrl:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"https://cdn.visitkorea.or.kr/img/call?cmd=VIEW&id=5dc87836-b647-45ef-ae17-e3247f91b8b4"',computed:!1}},region:{required:!0,tsType:{name:"string"},description:""},distanceInfo:{required:!0,tsType:{name:"string"},description:""},regionTextStyle:{required:!1,tsType:{name:'Parameters[0]["textStyle"]',raw:'Parameters<typeof Text>[0]["textStyle"]'},description:""},infoTextStyle:{required:!1,tsType:{name:'Parameters[0]["textStyle"]',raw:'Parameters<typeof Text>[0]["textStyle"]'},description:""},size:{required:!1,tsType:{name:"union",raw:"keyof typeof CARD_STYLES",elements:[{name:"literal",value:"large"},{name:"literal",value:"medium"},{name:"literal",value:"small"}]},description:"",defaultValue:{value:'"large"',computed:!1}},width:{required:!1,tsType:{name:"string"},description:""},as:{required:!1,tsType:{name:"ElementType"},description:"",defaultValue:{value:'"div"',computed:!1}},onClick:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./src/components/Header.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Header});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),next_image__WEBPACK_IMPORTED_MODULE_2__=(__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),__webpack_require__("./node_modules/@storybook/nextjs/dist/images/next-image.mjs"));function Header({user,onClickLogo,onClickProfile}){return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("header",{className:"w-full bg-white shadow z-50",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"mx-auto max-w-[1100px] px-5 py-3.5 h-[60px] flex items-center justify-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"cursor-pointer",onClick:onClickLogo,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_image__WEBPACK_IMPORTED_MODULE_2__.A,{src:"/icons/MainLogo.webp",alt:"모먼티어 메인로고 이미지",width:137,height:28})}),user?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"flex items-center gap-4",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(next_image__WEBPACK_IMPORTED_MODULE_2__.A,{src:"/icons/Avatar.svg",alt:"유저프로필이미지",width:40,height:40,onClick:onClickProfile})}):null]})})}Header.__docgenInfo={description:"",methods:[],displayName:"Header",props:{user:{required:!0,tsType:{name:"union",raw:"User | null",elements:[{name:"User"},{name:"null"}]},description:""},onClickLogo:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onClickProfile:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}}},"./src/components/Text.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Text});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js");const TEXT_STYLES={display1:"text-[56px] leading-[72px] tracking-[-0.0316em]",display2:"text-[40px] leading-[52px] tracking-[-0.0282em]",title1:"text-[36px] leading-[48px] tracking-[-0.0272em]",title2:"text-[28px] leading-[38px] tracking-[-0.0236em]",title3:"text-[24px] leading-[32px] tracking-[-0.0232em]",heading1:"text-[22px] leading-[30px] tracking-[-0.0176em]",heading2:"text-[20px] leading-[28px] tracking-[-0.012em]",headline1:"text-[18px] leading-[26px] tracking-[-0.002em]",headline2:"text-[17px] leading-[24px] tracking-[0em]",body1:"text-[16px] leading-[24px] tracking-[0.0057em]",body1Reading:"text-[16px] leading-[28px] tracking-[0.0057em]",body2:"text-[15px] leading-[22px] tracking-[0.0069em]",body2Reading:"text-[15px] leading-[26px] tracking-[0.0069em]",label1:"text-[14px] leading-[20px] tracking-[0.0145em]",label1Reading:"text-[14px] leading-[22px] tracking-[0.0145em]",label2:"text-[12px] leading-[18px] tracking-[0.0156em]",caption1:"text-[12px] leading-[16px] tracking-[0.0137em]",caption2:"text-[10px] leading-[14px] tracking-[0.0137em]"};function Text({as,textStyle="body1",className="",children,...props}){const Component=as||"span";var _TEXT_STYLES_textStyle;const styleClass=null!==(_TEXT_STYLES_textStyle=TEXT_STYLES[textStyle])&&void 0!==_TEXT_STYLES_textStyle?_TEXT_STYLES_textStyle:"";return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(Component,{className:`${styleClass} ${className}`,...props,children})}Text.__docgenInfo={description:"",methods:[],displayName:"Text",props:{as:{required:!1,tsType:{name:"T"},description:""},textStyle:{required:!1,tsType:{name:"union",raw:"keyof typeof TEXT_STYLES",elements:[{name:"literal",value:"display1"},{name:"literal",value:"display2"},{name:"literal",value:"title1"},{name:"literal",value:"title2"},{name:"literal",value:"title3"},{name:"literal",value:"heading1"},{name:"literal",value:"heading2"},{name:"literal",value:"headline1"},{name:"literal",value:"headline2"},{name:"literal",value:"body1"},{name:"literal",value:"body1Reading"},{name:"literal",value:"body2"},{name:"literal",value:"body2Reading"},{name:"literal",value:"label1"},{name:"literal",value:"label1Reading"},{name:"literal",value:"label2"},{name:"literal",value:"caption1"},{name:"literal",value:"caption2"}]},description:"",defaultValue:{value:'"body1"',computed:!1}},className:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'""',computed:!1}},children:{required:!0,tsType:{name:"ReactNode"},description:""}}}},"./src/lib/api/axiosInstance.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>api_axiosInstance});var useAuthStore=__webpack_require__("./src/store/useAuthStore.ts"),console=__webpack_require__("./node_modules/console-browserify/index.js");const useLoadingStore=(0,__webpack_require__("./node_modules/zustand/esm/react.mjs").v)((set=>({isLoading:!1,loadingType:"none",setLoading:(isLoading,type="fullscreen")=>set({isLoading,loadingType:isLoading?type:"none"})})));var axios=__webpack_require__("./node_modules/axios/lib/axios.js"),process=__webpack_require__("./node_modules/process/browser.js"),axiosInstance_console=__webpack_require__("./node_modules/console-browserify/index.js");const backendUrl=process.env.NEXT_PUBLIC_API_BASE_URL,axiosInstance_axiosInstance=axios.A.create({baseURL:backendUrl,headers:{"Content-Type":"application/json"},withCredentials:!0});axiosInstance_axiosInstance.interceptors.request.use((config=>{const{user}=useAuthStore.n.getState();var _config_loadingType;(null==user?void 0:user.accessToken)&&(config.headers.Authorization=`Bearer ${user.accessToken}`);const type=null!==(_config_loadingType=config.loadingType)&&void 0!==_config_loadingType?_config_loadingType:"fullscreen";return useLoadingStore.getState().setLoading(!0,type),config}),(error=>(useLoadingStore.getState().setLoading(!1),Promise.reject(error)))),axiosInstance_axiosInstance.interceptors.response.use((response=>(useLoadingStore.getState().setLoading(!1),response)),(async error=>{useLoadingStore.getState().setLoading(!1);const originalRequest=error.config;if(originalRequest.url.includes("/auth/token/reissue"))return axiosInstance_console.warn("🛑 토큰 재발급 요청은 인터셉터에서 무시합니다."),Promise.reject(error);if(!useAuthStore.n.getState().isLoggedIn)return axiosInstance_console.warn("🔒 로그아웃 상태입니다. 요청 중단"),Promise.reject(error);if(401===error.response.status&&!originalRequest._retry){originalRequest._retry=!0,axiosInstance_console.warn("🔄 401 발생, 토큰 재발급 시도 중...");const newAccessToken=await(async()=>{try{const response=await api_axiosInstance.post("/auth/token/reissue");if(200===response.status){const{accessToken,userName,expiresIn,hasSubmittedExperience}=response.data;return useAuthStore.n.getState().refresh({accessToken,expiresIn}),console.log("🔄 토큰 재발급 성공"),response.data}return console.error("❌ 토큰 재발급 실패"),useAuthStore.n.getState().logout(),null}catch(error){return console.error("토큰 재발급 중 오류 발생:",error),useAuthStore.n.getState().logout(),null}})();if(newAccessToken)return axiosInstance_console.log("✅ 토큰 재발급 성공, 요청 재시도"),originalRequest.headers.Authorization=`Bearer ${newAccessToken}`,axiosInstance_axiosInstance(originalRequest);axiosInstance_console.error("❌ 토큰 재발급 실패, 로그아웃 처리"),useAuthStore.n.getState().logout(),window.location.href="/main"}return Promise.reject(error)}));const api_axiosInstance=axiosInstance_axiosInstance},"./src/lib/api/itinerary.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{RR:()=>getRecommendedDestinations,VX:()=>getPublicItineraries,gJ:()=>changeAttraction,o9:()=>getRecommendText});var _axiosInstance__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/lib/api/axiosInstance.ts");const getRecommendedDestinations=async data=>{try{return(await _axiosInstance__WEBPACK_IMPORTED_MODULE_0__.A.get("/itinerary/preview",{params:data})).data}catch(error){var _error_response;throw new Error((null===(_error_response=error.response)||void 0===_error_response?void 0:_error_response.data.message)||"추천 장소를 불러오지 못했습니다.")}},getPublicItineraries=async limit=>{try{return(await _axiosInstance__WEBPACK_IMPORTED_MODULE_0__.A.get(`/itinerary/public?limit=${limit}`)).data}catch(error){var _error_response;throw new Error((null===(_error_response=error.response)||void 0===_error_response?void 0:_error_response.data.message)||"공개된 여행 코스 목록을 불러오지 못했습니다.")}},getRecommendText=async(params="")=>{try{return(await _axiosInstance__WEBPACK_IMPORTED_MODULE_0__.A.get("/itinerary/recommend/text",{params:{input:params},loadingType:"none"})).data}catch(err){var _err_response;throw new Error((null===(_err_response=err.response)||void 0===_err_response?void 0:_err_response.data.message)||"여행테마 추천 검색어 불러오기에 실패했습니다.")}},changeAttraction=async data=>{try{return(await _axiosInstance__WEBPACK_IMPORTED_MODULE_0__.A.post("/itinerary/change/attraction",data)).data}catch(error){var _error_response;throw new Error((null===(_error_response=error.response)||void 0===_error_response?void 0:_error_response.data.message)||"관광지 정보를 변경하지 못했습니다.")}}},"./src/store/useAuthStore.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{n:()=>useAuthStore});var zustand__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/zustand/esm/react.mjs"),zustand_middleware__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/zustand/esm/middleware.mjs"),console=__webpack_require__("./node_modules/console-browserify/index.js");const useAuthStore=(0,zustand__WEBPACK_IMPORTED_MODULE_0__.v)()((0,zustand_middleware__WEBPACK_IMPORTED_MODULE_1__.Zr)(((set,get)=>({isLoggedIn:!1,user:null,hasHydrated:!1,setHasHydrated:value=>set({hasHydrated:value}),login:user=>{set({isLoggedIn:!0,user})},refresh:token=>{const currentUser=get().user;if(currentUser){const updatedUser={...currentUser,accessToken:token.accessToken,expiresIn:token.expiresIn};set({isLoggedIn:!0,user:updatedUser})}else console.warn("User not found. Cannot refresh token.")},logout:()=>{set({isLoggedIn:!1,user:null})}})),{name:"auth-storage",onRehydrateStorage:()=>state=>{null==state||state.setHasHydrated(!0)}}))},"./src/stories/MainPage.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{__namedExportsOrder:()=>__namedExportsOrder,default:()=>MainPage_stories,메인페이지:()=>메인페이지});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),Header=__webpack_require__("./src/components/Header.tsx"),Card=__webpack_require__("./src/components/Card.tsx"),Text=__webpack_require__("./src/components/Text.tsx"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),navigation=__webpack_require__("./node_modules/@storybook/nextjs/dist/export-mocks/navigation/index.mjs"),useAuthStore=__webpack_require__("./src/store/useAuthStore.ts"),process=__webpack_require__("./node_modules/process/browser.js");var itinerary=__webpack_require__("./src/lib/api/itinerary.ts");function Main(){const[cards,setCards]=(0,react.useState)([]),[loading,setLoading]=(0,react.useState)(!1),[error,setError]=(0,react.useState)(null),sliderRef=(0,react.useRef)(null),mainRef=(0,react.useRef)(null),{openPopupAndHandleLogin}=function useLogin(){const loginState=(0,useAuthStore.n)((state=>state.login)),router=(0,navigation.useRouter)(),popupRef=(0,react.useRef)(null);return{openPopupAndHandleLogin:()=>{const clientId=process.env.NEXT_PUBLIC_KAKAO_CLIENT_ID,redirectUri=process.env.NEXT_PUBLIC_KAKAO_REDIRECT_URI,url=`https://kauth.kakao.com/oauth/authorize?client_id=${clientId}&redirect_uri=${encodeURIComponent(redirectUri)}&response_type=code`,left=window.screenX+(window.innerWidth-500)/2,top=window.screenY+(window.innerHeight-600)/2;popupRef.current=window.open(url,"kakaoLogin",`width=500,height=600,left=${left},top=${top},resizable=no,scrollbars=yes`);const handleMessage=event=>{const{type,payload,error}=event.data||{};if("KAKAO_LOGIN_SUCCESS"===type){var _popupRef_current,_payload_userName;const user={userName:null!==(_payload_userName=payload.userName)&&void 0!==_payload_userName?_payload_userName:"",accessToken:payload.accessToken,expiresIn:payload.expiresIn,profileImage:payload.profileImage,hasSubmittedExperience:payload.hasSubmittedExperience};loginState(user),router.push("/userinputs"),window.removeEventListener("message",handleMessage),null===(_popupRef_current=popupRef.current)||void 0===_popupRef_current||_popupRef_current.close()}else if("KAKAO_LOGIN_FAILURE"===type){var _popupRef_current1;alert("로그인 실패: "+error),window.removeEventListener("message",handleMessage),null===(_popupRef_current1=popupRef.current)||void 0===_popupRef_current1||_popupRef_current1.close()}};window.addEventListener("message",handleMessage)}}}(),{isLoggedIn}=(0,useAuthStore.n)(),router=(0,navigation.useRouter)();return(0,react.useEffect)((()=>{(async()=>{setLoading(!0);try{const data=await(0,itinerary.VX)(15);setCards(data)}catch(err){setError(err.message)}finally{setLoading(!1)}})()}),[]),(0,react.useEffect)((()=>{const slider=sliderRef.current,container=mainRef.current;if(!slider||!container)return;const frame=()=>{const containerCenter=container.clientWidth/2,children=Array.from(slider.children),sorted=children.map((child=>{const rect=child.getBoundingClientRect(),cardCenter=rect.left+rect.width/2;return{el:child,distance:Math.abs(containerCenter-cardCenter)}})).sort(((a,b)=>a.distance-b.distance));children.forEach((child=>{child.classList.remove("opacity-100"),child.classList.add("opacity-50")})),sorted.slice(0,3).forEach((({el})=>{el.classList.remove("opacity-50"),el.classList.add("opacity-100")})),requestAnimationFrame(frame)};requestAnimationFrame(frame)}),[]),(0,jsx_runtime.jsxs)("div",{ref:mainRef,className:"w-full",children:[(0,jsx_runtime.jsxs)("main",{className:"mt-[188px] text-center",children:[(0,jsx_runtime.jsxs)(Text.A,{as:"h1",textStyle:"display1",className:"font-bold",children:["어디로 떠날지 고민 중이라면, ",(0,jsx_runtime.jsx)("br",{}),"모먼티어가 도와드릴게요"]}),(0,jsx_runtime.jsx)(Text.A,{as:"p",textStyle:"heading2",className:"mt-5 font-semibold",children:"복잡한 일정 없이, 몇 가지 정보만 알려주시면 추천은 저희가 알아서 해드려요."})]}),(0,jsx_runtime.jsx)("section",{className:"relative group mt-[80px]",children:loading?(0,jsx_runtime.jsx)("div",{className:"text-center text-gray-500",children:"로딩 중..."}):error?(0,jsx_runtime.jsxs)("div",{className:"text-center text-red-500",children:["에러 발생: ",error]}):(0,jsx_runtime.jsx)("div",{ref:sliderRef,className:"flex w-max gap-4 animate-marquee",children:cards.map((card=>(0,jsx_runtime.jsx)("div",{className:"transition-transform duration-300 hover:scale-105",children:(0,jsx_runtime.jsx)(Card.A,{size:"small",region:card.title,distanceInfo:"알 수 없음",onClick:()=>router.push("/travel/detail/"+card.id),imageUrl:card.image_url?card.image_url:"https://cdn.visitkorea.or.kr/img/call?cmd=VIEW&id=5dc87836-b647-45ef-ae17-e3247f91b8b4"})},card.id)))})}),(0,jsx_runtime.jsx)("section",{className:"mt-8 flex justify-center",children:(0,jsx_runtime.jsxs)("button",{className:"flex px-5 py-[13px] bg-[#FFE812] rounded-full cursor-pointer",onClick:()=>isLoggedIn?router.push("/userinputs"):openPopupAndHandleLogin(),children:[(0,jsx_runtime.jsx)("img",{src:"/icons/kakao.png",alt:"kakao icon"}),(0,jsx_runtime.jsx)(Text.A,{textStyle:"headline1",className:"ml-2 font-semibold",children:isLoggedIn?"시작하기":"카카오로 시작하기"})]})})]})}function MainPage(){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Header.A,{user:{userName:"Jane Doe",accessToken:"dummy-access-token",profileImage:"/icons/Avatar.svg",expiresIn:1e5},onClickLogo:()=>{}}),(0,jsx_runtime.jsx)(Main,{})]})}Main.__docgenInfo={description:"",methods:[],displayName:"Main"},MainPage.__docgenInfo={description:"",methods:[],displayName:"MainPage"};const MainPage_stories={title:"Pages/MainPage",component:MainPage,parameters:{layout:"fullscreen"}},메인페이지={},__namedExportsOrder=["메인페이지"];메인페이지.parameters={...메인페이지.parameters,docs:{...메인페이지.parameters?.docs,source:{originalSource:"{}",...메인페이지.parameters?.docs?.source}}}}}]);